---

- name: Install dependencies
  become: yes
  become_user: "{{ dashboard.name }}"
  command: "cp -R /home/{{ dashboard.name }}/core/example /home/{{ dashboard.name }}/web"
  args:
    creates: "/home/{{ dashboard.name }}/web"

- name: Ensure core symlinks
  become: yes
  become_user: "{{ dashboard.name }}"
  file:
    state: link
    force: yes
    src: "/home/{{ dashboard.name }}/core/{{ item }}"
    dest: "/home/{{ dashboard.name }}/web/{{ item }}"
  with_items:
    - vendor

- name: Ensure resources symlinks
  become: yes
  become_user: "{{ dashboard.name }}"
  file:
    state: link
    force: yes
    src: "/home/{{ dashboard.name }}/core/src/Hoborg/Dashboard/Resources/{{ item }}"
    dest: "/home/{{ dashboard.name }}/web/{{ item }}"
  with_items: "{{ dashboard.resources }}"
